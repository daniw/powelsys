\documentclass[a4paper,11pt,fleqn]{article}

\usepackage{layout}

\title{Power electronic systems - Exercise 5.5}
\author{Daniel Winz}
\date{\today}

%\includeonly{}

\begin{document}

\section{Exercise}
Given is the following boost converter: 

\[ V_o = \SI{200}{\volt} \]
\[ L = \SI{200}{\micro\henry} \]
\[ C = \SI{5}{\micro\farad} \]
\[ R = \SI{50}{\ohm} \]
\[ f_s = \SI{100}{\kilo\hertz} \]

\begin{circuitikz}[european voltages, european resistors, american inductors]
    \draw (0,0)
    to[V, v<=$V_i$]         +( 0, 2)
    to[short, i>^=$I_i$]    +( 1, 0)
    to[L=L, -*]             +( 2, 0)
    to[D, l=D, -*]          +( 2, 0)
    to[short, i>^=$I_o$]    +( 2, 0)
    to[R=R]                 +( 0,-2)
    to[short, -*]           +(-2, 0)
    to[short, -*]           +(-2, 0)
    to[short]               +(-3, 0)
    (5, 2) to[C=C]          (5,0)
    (3,1) node[nigfete=Q] (fet) {}
    (fet) node[right] {Q}
    (fet.S) to[short] (3,0)
    (fet.D) to[short] (3,2)
    (7.5,2) to[open, v^>=$V_0$] (7.5,0)
    ;
\end{circuitikz}

\section{Solution}
The duty ratio for different input voltages is calculated using the volt 
second balance. 
\[ V_{L_1} \cdot D + V_{L_2} \cdot (1 - D) = 0 \]
\[ V_{L_1} = V_i \qquad V_{L_2} = V_i - V_o \]
\[ \to V_i \cdot D + (V_i - V_o) \cdot (1 - D) = 0 \]
\[ V_i \cdot D + V_i \cdot (1 - D) - V_o \cdot (1 - D) = 0 \]
\[ V_i \cdot \underbrace{(D + 1 - D)}_{1} = V_o \cdot (1 - D) \]
%\[ V_o = \dfrac{V_i}{1 - D} \]
%\[ M(D) = \dfrac{V_o}{V_i} = \dfrac{1}{1 - D} \]
\[ \underline{D = 1 - \dfrac{V_i}{V_o}} \]

\begin{table}[h!]
    \centering
    \begin{zebratabular}{lll}
        \rowcolor{gray}
        $V_i$ [\si{\volt}]  & $V_o$ [\si{\volt}]    & $D$ [\,]\\
         50 & 200   & 0.75  \\
        100 & 200   & 0.5   \\
        150 & 200   & 0.25  \\
    \end{zebratabular}
    \caption{Duty cycle for several input voltages}
    \label{tab:duty}
\end{table}

\begin{figure}[h!]
    \centering
    \missingfigure{CCM plot}
    \caption{CCM analysis over complete input voltage range}
    \label{fig_ccm}
\end{figure}

For each input voltage it is checked, if the converter is still in continuous 
conduction mode (CCM). 
\[ \Delta I_L < 2 \cdot I_o \]
\[ \dfrac{V_i \cdot D}{L \cdot f_s} < 2 \cdot \dfrac{V_o}{R} \]
\[ D < 2 \cdot \dfrac{V_o \cdot L \cdot f_s}{R \cdot V_i} \]

To determine the transfer function of the converter state-space-averaging is used. The State variables are the inductor current $i_L$ and the output capacitor voltage $v_c$. 
\[ X = \begin{bmatrix}i_L\\v_c\end{bmatrix} \]
The output voltage is equal to the capacitor voltage. 
\[ F = \begin{bmatrix}0 & 1\end{bmatrix} \]
\[ v_o = F \cdot X \]

\begin{multicols}{2}
    \subsubsection*{Interval 1:}
        \begin{circuitikz}[scale=0.9, european voltages, european resistors, american inductors]
            \draw (0,0)
            to[V, v<=$V_i$]         +( 0, 2)
            to[short, i>^=$I_i$]    +( 1, 0)
            to[L=L]                 +( 2, 0)
            to[open]                +( 2, 0)
            to[short, i>^=$I_o$]    +( 2, 0)
            to[R=R]                 +( 0,-2)
            to[short, -*]           +(-2, 0)
            to[short, -*]           +(-2, 0)
            to[short]               +(-3, 0)
            (5, 2) to[C=C]          (5,0)
            (3,0) to[short] (3,2)
            (7.5,2) to[open, v^>=$V_0$] (7.5,0)
            ;
        \end{circuitikz}
    \[ \dfrac{di_L}{dt} = \dfrac{v_L}{L} = \dfrac{v_i}{L} \]
    \[ \dfrac{dv_C}{dt} = \dfrac{i_C}{C} = \dfrac{-i_o}{C} = \dfrac{-v_c}{R \cdot C} \]
    \[ \underbrace{
        \begin{bmatrix}
            \dfrac{di_L}{dt} \\
            \dfrac{dv_C}{dt}
        \end{bmatrix}}_{\dot{x}} 
    = 
        \underbrace{
        \begin{bmatrix}
            0 & 0 \\
            0 & \dfrac{-1}{R \cdot C}
        \end{bmatrix}}_{A_1} 
    \cdot
        \underbrace{
        \begin{bmatrix}
            i_L \\
            v_C
        \end{bmatrix}}_{x} 
    +
        \underbrace{
        \begin{bmatrix}
            \dfrac{v_i}{L} \\
            0
        \end{bmatrix}}_{B_1} 
    \]
    \[ \dot{x} = A_1 \cdot x + B_1 \]
\columnbreak
    \subsubsection*{Interval 2:}
        \begin{circuitikz}[scale=0.9, european voltages, european resistors, american inductors]
            \draw (0,0)
            to[V, v<=$V_i$]         +( 0, 2)
            to[short, i>^=$I_i$]    +( 1, 0)
            to[L=L]                 +( 2, 0)
            to[short, -*]           +( 2, 0)
            to[short, i>^=$I_o$]    +( 2, 0)
            to[R=R]                 +( 0,-2)
            to[short, -*]           +(-2, 0)
            to[short]               +(-2, 0)
            to[short]               +(-3, 0)
            (5, 2) to[C=C]          (5,0)
            (7.5,2) to[open, v^>=$V_0$] (7.5,0)
            ;
        \end{circuitikz}
    \[ \dfrac{di_L}{dt} = \dfrac{v_L}{L} = \dfrac{v_i - v_c}{L} \]
    \[ \dfrac{dv_C}{dt} = \dfrac{i_C}{C} = \dfrac{i_L - i_o}{C} = \dfrac{i_L}{C} - \dfrac{v_c}{R \cdot C} \]
    \[ \underbrace{
        \begin{bmatrix}
            \dfrac{di_L}{dt} \\
            \dfrac{dv_C}{dt}
        \end{bmatrix}}_{\dot{x}} 
    = 
        \underbrace{
        \begin{bmatrix}
            0 & \dfrac{-1}{L} \\
            \dfrac{1}{C} & \dfrac{-1}{R \cdot C}
        \end{bmatrix}}_{A_2} 
    \cdot
        \underbrace{
        \begin{bmatrix}
            i_L \\
            v_C
        \end{bmatrix}}_{x} 
    +
        \underbrace{
        \begin{bmatrix}
            \dfrac{v_i}{L} \\
            0
        \end{bmatrix}}_{B_2} 
    \]
    \[ \dot{x} = A_2 \cdot x + B_2 \]
\end{multicols}

\[ D' = 1 - D \qquad D + D' = 1 \]
\[ A = A_1 \cdot D + A_2 \cdot D'
     = \begin{bmatrix}
            0 & 0 \\
            0 & \dfrac{-1}{R \cdot C}
        \end{bmatrix}
     \cdot D
     + \begin{bmatrix}
            0 & \dfrac{-1}{L} \\
            \dfrac{1}{C} & \dfrac{-1}{R \cdot C}
        \end{bmatrix}
     \cdot D'
     = \begin{bmatrix}
            0 & \dfrac{-D'}{L} \\
            \dfrac{D'}{C} & \dfrac{-1}{R \cdot C}
        \end{bmatrix}
     = \begin{bmatrix}
            0 & \dfrac{D-1}{L} \\
            \dfrac{1-D}{C} & \dfrac{-1}{R \cdot C}
        \end{bmatrix}
\]
\[ B = B_1 \cdot D + B_2 \cdot D'
     = \begin{bmatrix}
            \dfrac{v_i}{L} \\
            0
        \end{bmatrix}
     \cdot D 
     + \begin{bmatrix}
            \dfrac{v_i}{L} \\
            0
        \end{bmatrix}
     \cdot D'
     = \begin{bmatrix}
            \dfrac{v_i}{L} \\
            0
        \end{bmatrix}
\]
\[ X = \begin{bmatrix}i_L\\v_c\end{bmatrix} = -A^{-1} \cdot B 
     = -\begin{bmatrix}
            \dfrac{-L}{(D - 1)^2 \cdot R} & \dfrac{-C}{D - 1} \\
            \dfrac{L}{D-1} & 0
        \end{bmatrix} \cdot B
     = \begin{bmatrix}
            \dfrac{v_i}{(D - 1)^2 \cdot R} \\
            \dfrac{-v_i}{D-1}
        \end{bmatrix}
\]
\[ E = (A_1 - A_2) \cdot X + B_1 - B_2
     = \begin{bmatrix}
            \dfrac{v_c}{L} \\
            \dfrac{-i_l}{C}
        \end{bmatrix}
\]
\[ H(s) = \dfrac{\hat{V}_o(s)}{\hat{D}(s)} = F \cdot (s \cdot I - A)^{-1} \cdot E
    = \dfrac{\dfrac{v_C}{1 - D} - \dfrac{L \cdot i_L}{(1 - D)^2} \cdot s}
        {1 + \dfrac{L}{R \cdot (1 - D)^2} \cdot s + \dfrac{C \cdot L}{(1 - D)^2} \cdot s^2}
\]
\[ v_C = v_o \qquad i_L = \dfrac{v_o}{(1 - D) \cdot R} \]
\[ H(s) = \dfrac{\dfrac{v_o}{1 - D} - \dfrac{L \cdot v_o}{(1 - D)^3 \cdot R} \cdot s}
        {1 + \dfrac{L}{R \cdot (1 - D)^2} \cdot s + \dfrac{C \cdot L}{(1 - D)^2} \cdot s^2}
    = \dfrac{v_o}{1 - D} \cdot \dfrac{1 - \dfrac{L}{(1 - D)^2 \cdot R} \cdot s}
        {1 + \dfrac{L}{R \cdot (1 - D)^2} \cdot s + \dfrac{C \cdot L}{(1 - D)^2} \cdot s^2}
\]

\end{document}
